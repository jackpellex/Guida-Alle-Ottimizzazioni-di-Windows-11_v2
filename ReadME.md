# Guida Avanzata alle Ottimizzazioni su Windows 11

> üéÆ **Ottimizza Windows 11 per il gaming e l‚Äôuso quotidiano** üîß  
> Progettata per **utenti esperti e non**, questa guida ti mostra percorsi **sicuri e avanzati** per massimizzare le prestazioni software e hardware del tuo PC.

## CleanOS: Personalizza la Tua Installazione di Windows 11 per una Base Stabile

Prima di immergerti nelle ottimizzazioni, puoi gettare le fondamenta per un sistema pulito e performante. Questa guida include una sezione dedicata a **CleanOS**, che ti permette di creare un'installazione personalizzata di Windows 10/11 fin dall'inizio.

Questo significa che potrai avere un'immagine ISO su misura, **priva di bloatware** (software preinstallato non necessario) e gi√† configurata con le tue preferenze di lingua, regione, account utente, impostazioni di rete e privacy.

Utilizzando l'**Unattend Generator** e seguendo il percorso indicato in `2_Personalizzazione/CleanOS.md`, ti assicurerai che il tuo sistema parta gi√† da una **base stabile e ottimizzata**, priva di elementi superflui che potrebbero influire sulle prestazioni future.

---

## üìë Indice

1. [Scopo della Guida](#scopo-della-guida)  
2. [Struttura delle Cartelle](#struttura-delle-cartelle)  
3. [Prestazioni Realistiche vs. Extreme Tuning](#prestazioni-realistiche-vs-extreme-tuning)  
4. [Sezioni Principali](#sezioni-principali)  
   - [Ottimizzazioni](#ottimizzazioni)  
   - [Personalizzazione](#personalizzazione)  
   - [Risoluzione Errori](#risoluzione-errori)  
   - [Sicurezza](#sicurezza)  
5. [Linee Guida di Stile](#linee-guida-di-stile)  

---

## Scopo della Guida

Questa guida ti accompagner√† passo dopo passo nell‚Äô**ottimizzazione di Windows 11** con un focus sul **gaming** e sul **massimo rendimento** del sistema:

- Percorsi **sicuri**: modifiche consigliate per un +8% medio di FPS e minore latenza input.  
- **Extreme tuning**: opzioni **sconsigliate** per un potenziale +30‚Äì40% FPS, evidenziate con avvertenze chiare (rischio di instabilit√† variabile a seconda della configurazione).

Perfetta sia per chi vuole migliorare in modo stabile, sia per sperimentatori pronti a correre qualche rischio.

---

## Struttura delle Cartelle

- **App_e_Siti/**: applicazioni e risorse esterne per test hardware, monitoraggio e ottimizzazione.  
- **Collegamenti/**: scorciatoie a impostazioni di sistema e tool avanzati.  
- **Icone/**: set di icone personalizzate per abbellire e distinguere le cartelle.  
- **1_Ottimizzazioni/**: tecniche di tuning per CPU, GPU, I/O e avvio di sistema.  
- **2_Personalizzazione/**: temi, layout, automazioni e script per adattare UI/UX.  
- **3_Risoluzione_Errori/**: diagnostica, log, riparazione file e recupero configurazioni.  
- **4_Sicurezza/**: hardening, crittografia, protezione memoria e best practice difensive.  
- **README.md**: punto di partenza e indice di tutta la guida.

> Le cartelle **1‚Äì4** sono il cuore dell‚Äôottimizzazione: esplorale con ordine e attenzione.

---
## Prestazioni Realistiche vs. Extreme Tuning

Quando si parla di ottimizzazione delle prestazioni grafiche (tuning), √® fondamentale distinguere tra un approccio sicuro e uno pi√π estremo, soprattutto in base all'hardware del proprio sistema.

### Sistemi Moderni

Per i sistemi pi√π recenti, equipaggiati con hardware performante, le aspettative di miglioramento dovrebbero essere realistiche e mirate alla stabilit√†:

* **Tuning Sicuro:** Questo tipo di ottimizzazione punta a un aumento medio delle prestazioni di circa **+8% di FPS**, garantendo al contempo una maggiore fluidit√† di gioco e una riduzione della latenza. Si concentra su piccole modifiche che migliorano l'esperienza senza compromettere la stabilit√† del sistema.
* **Tuning Estremo (Sconsigliato):** Spingersi oltre con un tuning aggressivo pu√≤ portare a un incremento degli FPS **fino al +30-40%**. Tuttavia, questo approccio √® altamente **sconsigliato** a causa dell'elevato **rischio di crash**, l'insorgere di artefatti video e una generale instabilit√† del sistema. I benefici percepiti non giustificano i potenziali problemi.

### Sistemi Meno Recenti

Per i sistemi pi√π datati, l'ottimizzazione pu√≤ offrire margini di miglioramento potenzialmente pi√π significativi, dato che il software √® spesso pi√π limitato dall'hardware obsoleto:

* **Tuning Sicuro:** Anche su hardware pi√π vecchio, un tuning sicuro pu√≤ portare a benefici interessanti. L'aumento medio degli FPS potrebbe essere **superiore al +8%** visto sui sistemi moderni, contribuendo a rendere i giochi pi√π giocabili e reattivi, pur mantenendo un'ottima stabilit√†.
* **Tuning Estremo (Sconsigliato):** Similmente ai sistemi moderni, anche sui PC meno recenti il tuning estremo pu√≤ promettere incrementi di FPS **fino al +30-40% o anche di pi√π**. Tuttavia, i rischi di **instabilit√†, crash frequenti e artefatti visivi** sono ancora pi√π elevati su hardware meno tollerante. La stabilit√† del sistema ne risentirebbe gravemente, compromettendo l'usabilit√† generale.

> ‚ö†Ô∏è Ogni modifica estrema √® segnalata da un avviso e va testata su singola macchina.


---

## Sezioni Principali

### Ottimizzazioni üìà
- **Aggiornamento Applicazioni**:
  - Utilizza **winget** e **Chocolatey** per mantenere software aggiornati con un singolo comando: `winget upgrade --all` o `choco upgrade all -y`.
- **Eseguibile .bat**:
  - Script di pulizia per eliminare file temporanei: `cleanmgr /sagerun:1` o personalizza un `.bat` che rimuove `%temp%`, cache browser e log di sistema obsoleti.
- **BIOS Tweaks** (‚ö†Ô∏è sconsigliato in ambienti di produzione):
  - **Hyper-Threading Disabled** per ridurre latenza in alcuni giochi CPU-bound.
- **Terminale PowerShell**:
  - **Compressione della memoria**: `Enable-MMAgent -MemoryCompression`.
  - **Sleep States**: disabilita stati di basso consumo (S1‚ÄìS3) in sistemi desktop per ridurre lag.
- **Configurazione di Sistema**:
  - Rilevamento e affinit√† core avanzata via `bcdedit /set {current} numproc N`.
- **Ottimizzazione Connessione e Rete**:
  - Regola TCP Window Scaling e auto-tuning: `netsh interface tcp set global autotuninglevel=high`.
- **Gestione Attivit√†**:
  - Disabilita startup non necessari dal Task Manager.
  - Imposta priorit√† app gaming su **Alta**.
  - Usa **Process Explorer** per analisi avanzata.
- **Gestione Disco**:
  - Deframmentazione SSD disabilitata, esegui TRIM: `Optimize-Volume -DriveLetter C -ReTrim -Verbose`.
  - Indicizzazione file: Mantiene un indice per ricerche rapide. Benefico per la velocit√† di ricerca su desktop moderni (SSD). Configura le "Opzioni di indicizzazione" per includere/escludere specifiche cartelle.
- **GPU Tweaks**:
  - Regola consumi e power limit via tool del vendor (NVIDIA/AMD).
  - Abilita riduzione latenza input nei driver.
  - Comprendi e scegli tra Fullscreen Esclusivo e Finestra Borderless per ottimizzare ulteriormente le performance e la latenza.
- **HPET** (‚ö†Ô∏è sconsigliato):
  - `bcdedit /set useplatformclock true/false`, testare per possibili miglioramenti di stabilit√†.
- **Impostazioni di Sistema**:
  - Disabilita app in background.
  - Usa il **Sensore di memoria** in Sicurezza di Windows.
  - Disattiva raccolta Telemetria superflua e colori non essenziali.
- **Opzioni Prestazioni**:
  - Configura Memoria Virtuale manualmente: dimensione iniziale e massima tra 1.5√ó RAM e 3.0x RAM. Assicurati di riservare abbastanza spazio libero sul disco (almeno 1,5x - 3x della RAM disponibile)
  - Ottimizza effetti visivi su **Prestazioni migliori**.
- **Programmi da Disinstallare**:
  - Rimuovi app preinstallate non necessarie dal Pannello di controllo.
- **Performance Monitor**:
  - Crea baseline di prestazioni e traccia counter critici.
- **Editor del Registro (Regedit)** (‚ö†Ô∏è):
  - Abilita **Fast Startup**: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Power` ‚Üí `HiberbootEnabled = 1`.
  - Disabilita GameDVR: `HKEY_CURRENT_USER\System\GameConfigStore` ‚Üí `GameDVR_Enabled = 0`.
  - Imposta `SvcHostSplitThresholdInKB` e `Win32PrioritySeparation` per bilanciare avvio servizi e priorit√†.
  - Ottimizza la priorit√† per i giochi: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games` ‚Üí imposta `GPU Priority = 8`, `Priority = 6` e `Scheduling Category = High` per migliorare FPS e reattivit√†.
- **Resource Monitor**:
  - Monitora I/O, CPU, RAM e rete in tempo reale per individuare colli di bottiglia.
- **Servizi Windows**:
  - Disattiva servizi non essenziali (Fax, Print Spooler se non usati).
  - Mantieni attivo **Windows Update**, **Security Center** e **Driver Frameworks**.

### Personalizzazione üé®
- **Installazione Personalizzata e Automatizzata (CleanOS)**:
¬† - Vuoi un'installazione di Windows 10/11 su misura, senza bloatware e con le tue configurazioni predefinite? Segui la guida **CleanOS.md** nella cartella **2_Personalizzazione/** per creare un supporto di installazione automatico e pulito usando l'Unattend Generator. Questo ti permette di definire lingua, regione, account utente, impostazioni di rete e privacy fin dal primo avvio del sistema.
- **Desktop Pulito**:
¬† - Mantieni il desktop il pi√π sgombro possibile: sposta Documenti, Download e collegamenti in cartelle dedicate (`C:\Users\%USERNAME%\Documenti`, ecc.). ¬†
¬† - Organizza i file con struttura gerarchica e usa **cartelle dei Preferiti** nel File Explorer. ¬†
¬† - Riduci il caricamento di file all‚Äôavvio: rimuovi shortcut superflui dalla cartella `Startup` (`shell:startup`).
- **Mouse Migliorato**:
¬† - **DPI**: configura DPI e Polling Rate dal software del driver (Logitech G HUB, Razer Synapse, ecc.) per trovare il giusto compromesso tra precisione e velocit√†.
¬† - **Disabilitazione accelerazione**: apri **Pannello di controllo ‚Üí Mouse ‚Üí Opzioni puntatore** e deseleziona **Migliora precisione puntatore**.
¬† - **Modifiche al Registro** (‚ö†Ô∏è)
- **Aggiustamenti dello Schermo**:
¬† - **Refresh Rate**: vai in **Impostazioni ‚Üí Sistema ‚Üí Schermo ‚Üí Impostazioni schermo avanzate** e seleziona il massimo refresh supportato.
¬† - **Calibrazione Colori**: esegui **Calibra colori dello schermo** da **Pannello di controllo ‚Üí Schermo** per regolare gamma, luminosit√† e contrasto.
¬† - **Scaling DPI**: in **Impostazioni ‚Üí Sistema ‚Üí Schermo**, regola lo **scaling** su percentuali personalizzate per evitare sfasamenti grafici su display ad alta risoluzione.

### Risoluzione Errori üõ†Ô∏è

In questa sezione troverai strumenti e procedure per individuare e correggere problemi comuni su Windows 11. L‚Äôobiettivo √® garantire **stabilit√†**, **ripristino rapido** e **prestazioni costanti** del sistema operativo.

#### üßÆ Comandi Utili da Terminale

- `CHKDSK`: verifica e corregge errori del file system.  
- `DISM /Online /Cleanup-Image /RestoreHealth`: ripara l'immagine di sistema danneggiata.  
- `SFC /scannow`: ripristina file di sistema corrotti.  
- `PowerCFG /energy`: analizza il consumo energetico e identifica inefficienze.  
- `Winsat formal`: aggiorna il punteggio prestazionale del sistema.

#### ‚öôÔ∏è Configurazione di Sistema

- Rilevamento errato dei core logici:  
  1. Apri **msconfig**.  
  2. Vai in **Avvio** ‚Üí **Opzioni avanzate**.  
  3. Imposta il numero di processori correttamente.

#### üíæ Disco: Deframmentazione e Ottimizzazione

- **HDD**: usa l‚ÄôUtilit√† ‚ÄúDeframmenta e ottimizza unit√†‚Äù.  
- **SSD**: lascia attiva l‚Äôottimizzazione automatica (no deframmentazione manuale!).

#### üß† Diagnostica della Memoria

- Avvia **Diagnostica memoria di Windows** (`mdsched.exe`) per testare eventuali problemi hardware nella RAM.

#### üßæ Event Viewer

- Accedi con `eventvwr.msc`.  
- Analizza i log di **Sistema**, **Applicazione** e **Sicurezza** per identificare crash o errori ricorrenti.

#### ‚ö†Ô∏è Errori 2502 e 2503

- Cause: permessi mancanti nelle cartelle temporanee.  
- Soluzioni:
  1. Esegui **Esplora file** come amministratore.  
  2. Modifica permessi su `C:\Windows\Temp` e `C:\Temp`.  
  3. Avvia l‚Äôinstallazione con privilegi elevati (`.msi` da prompt).

#### üß± Driver Grafici

- Usa **DDU (Display Driver Uninstaller)** in modalit√† provvisoria per rimuovere completamente i driver.  
- Reinstalla l‚Äôultima versione dal sito NVIDIA o AMD.

#### üìâ Monitoraggio Affidabilit√†

- Cerca **Affidabilit√†** nella barra di ricerca ‚Üí **Visualizza cronologia affidabilit√†**.  
- Monitora crash, errori e warning per identificare pattern di instabilit√†.

#### üîÅ QMR (Quick Machine Recovery)

- Sistema di snapshot e backup automatico.  
- Ripristina lo stato precedente in pochi istanti in caso di problemi critici.

#### üßº Strumento di Pulizia

- Esegui **Pulizia disco** o usa comandi PowerShell/Batch per:
  - Eliminare file temporanei, cache e log non necessari.  
  - Liberare spazio e migliorare la reattivit√† generale.

#### üõ†Ô∏è Strumento di Risoluzione dei Problemi

- Accesso rapido: `ms-settings:troubleshoot`.  
- Diagnostica guidata per audio, rete, aggiornamenti e periferiche.

#### üîÑ Script Batch: Reset Windows Update
In sintesi, lo script:

- Ferma i servizi di aggiornamento
- Elimina file e cache corrotti
- Ripara le registrazioni delle librerie critiche
- Ripristina componenti di rete
- Riavvia i servizi puliti

- Il risultato atteso √® un ambiente Windows Update ‚Äúresettato‚Äù, spesso risolutivo per errori come 0x80070005, download bloccati o aggiornamenti che non partono.

### Sicurezza üîí
Questa sezione copre le **misure difensive** e le **best practice** per proteggere il tuo sistema, i dati e gli account.

#### üõ°Ô∏è Disattivare Recall
- Windows Analizza immagini localmente con AI e salva risultati in un DB SQLite non crittografato nella cartella utente.
- Disabilita in **Impostazioni ‚Üí Privacy & sicurezza ‚Üí AI e servizi multimediali ‚Üí Recall**.

#### üîÑ Creazione Punto di Ripristino
> **PRIMA DI TUTTO**, crea sempre un punto di ripristino:  
1. Apri **Pannello di controllo ‚Üí Sistema ‚Üí Protezione sistema**.  
2. Seleziona l‚Äôunit√† di sistema e clicca **Crea‚Ä¶**.  
3. Nomina il punto e conferma.

#### üîê Gestione Disco: Crittografia
- **BitLocker On/Off**:
  - Attiva in **Pannello di controllo ‚Üí Sistema e sicurezza ‚Üí Crittografia unit√† BitLocker**.
  - Ricorda di salvare la chiave di ripristino.

#### ‚èØÔ∏è Disabilitare Autoplay
- Prevenzione: un drive USB con firmware riprogrammabile pu√≤ caricare malware automaticamente.
- Disattiva in **Impostazioni ‚Üí Dispositivi ‚Üí Autoplay ‚Üí Disattiva per tutti i supporti**.

#### üîí Sicurezza Account Google
- **Dispositivo perso**: revoca sessioni da https://myaccount.google.com/security ‚Üí **Gestisci dispositivi**.
- **Accesso software**: cambia password, abilita 2FA e rivedi app con accesso (OAuth).
- **Accesso fisico**: cancella token locali, modifica password e richiedi logout da tutti i dispositivi.

#### üïµÔ∏è‚Äç‚ôÇÔ∏è Identificare e Rimuovere Virus
- **Task Manager**: processi sospetti, uso anomalo di CPU/RAM.
- **Windows Defender**: esegui scansione completa e offline.
- **App di avvio**: disabilita voci non riconosciute in `shell:startup` e Task Manager.
- **Traffico rete**: `netstat -abno` per connettere processi a porte.

#### üñ•Ô∏è Problemi MiniPC Modificati
- Virus ‚ÄúPuabundlerWIN32‚Äù: malware preinstallato su MiniPC cinesi.
- **Rimozione**: avvia Safe Mode, esegui scansione Malwarebytes e Defender.
- **Sysinternals**:
  - **Autoruns** per controllare esecuzioni all‚Äôavvio.
  - **Process Explorer** per ispezionare DLL/caricamenti.
  - **TCPView** per connessioni sospette.

#### üõ°Ô∏è Potenziare Windows Defender
- **Memory Integrity**: Attiva in **Sicurezza di Windows ‚Üí Sicurezza dispositivo ‚Üí Integrit√† memoria**.
- **Periodic Scanning**: abilita scansione offline in Defender.

#### üìë Consigli Generali di Sicurezza
- Sistema operativo sempre aggiornato.  
- Usa password forti, 2FA e gestore di password.  
- Crittografa dischi e backup.  
- Scegli software open‚Äësource e rispetta il minimalismo digitale.  
- Naviga con browser privacy‚Äëoriented, VPN, DNS sicuri.  
- Imposta permessi restrittivi per app e servizi.  
- Disabilita Bluetooth/RF quando non in uso.  
- Valuta VM o OS alternativi per attivit√† sensibili.  
- Hardening avanzato tramite Group Policy e registry tweak.
- Documenta tutte le modifiche e automatizza verifiche periodiche.

---

## Linee Guida di Stile

- **Numerazione Step**  
- **Avvertenze** evidenziate con emoji ‚ö†Ô∏è e box dedicati.  
- **Backup & Ripristino** all‚Äôinizio di ogni sezione critica.  
- **Nomenclatura** coerente con prefisso numerico per ordine logico.

